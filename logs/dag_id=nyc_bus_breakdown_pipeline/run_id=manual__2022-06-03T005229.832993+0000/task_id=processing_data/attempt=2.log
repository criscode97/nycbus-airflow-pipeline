[2022-06-03 00:52:44,368] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: nyc_bus_breakdown_pipeline.processing_data manual__2022-06-03T00:52:29.832993+00:00 [queued]>
[2022-06-03 00:52:44,376] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: nyc_bus_breakdown_pipeline.processing_data manual__2022-06-03T00:52:29.832993+00:00 [queued]>
[2022-06-03 00:52:44,376] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-03 00:52:44,377] {taskinstance.py:1358} INFO - Starting attempt 2 of 2
[2022-06-03 00:52:44,378] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-03 00:52:44,396] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): processing_data> on 2022-06-03 00:52:29.832993+00:00
[2022-06-03 00:52:44,402] {standard_task_runner.py:52} INFO - Started process 5334 to run task
[2022-06-03 00:52:44,406] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'nyc_bus_breakdown_pipeline', 'processing_data', 'manual__2022-06-03T00:52:29.832993+00:00', '--job-id', '114', '--raw', '--subdir', 'DAGS_FOLDER/nycbus_etl.py', '--cfg-path', '/tmp/tmpppxhcqgp', '--error-file', '/tmp/tmpv8sxhmpe']
[2022-06-03 00:52:44,408] {standard_task_runner.py:80} INFO - Job 114: Subtask processing_data
[2022-06-03 00:52:44,550] {task_command.py:370} INFO - Running <TaskInstance: nyc_bus_breakdown_pipeline.processing_data manual__2022-06-03T00:52:29.832993+00:00 [running]> on host 8e84f5cf889f
[2022-06-03 00:52:44,636] {taskinstance.py:1572} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=***@example.com
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=nyc_bus_breakdown_pipeline
AIRFLOW_CTX_TASK_ID=processing_data
AIRFLOW_CTX_EXECUTION_DATE=2022-06-03T00:52:29.832993+00:00
AIRFLOW_CTX_TRY_NUMBER=2
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-06-03T00:52:29.832993+00:00
[2022-06-03 00:52:45,237] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/etls/transformations.py", line 78, in processing_data
    df[['Have_You_Alerted_OPT', 'Has_Contractor_Notified_Schools', 'Has_Contractor_Notified_Parents']] = df[['Have_You_Alerted_OPT', 'Has_Contractor_Notified_Schools', 'Has_Contractor_Notified_Parents']].apply(lambda x: yes_or_no(x))
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/frame.py", line 8740, in apply
    return op.apply()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/apply.py", line 688, in apply
    return self.apply_standard()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/apply.py", line 812, in apply_standard
    results, res_index = self.apply_series_generator()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/apply.py", line 828, in apply_series_generator
    results[i] = self.f(v)
  File "/opt/airflow/dags/etls/transformations.py", line 78, in <lambda>
    df[['Have_You_Alerted_OPT', 'Has_Contractor_Notified_Schools', 'Has_Contractor_Notified_Parents']] = df[['Have_You_Alerted_OPT', 'Has_Contractor_Notified_Schools', 'Has_Contractor_Notified_Parents']].apply(lambda x: yes_or_no(x))
  File "/opt/airflow/dags/etls/helpers.py", line 28, in yes_or_no
    return "Y" if string=="Yes" else "N"
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 1538, in __nonzero__
    f"The truth value of a {type(self).__name__} is ambiguous. "
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
[2022-06-03 00:52:45,255] {taskinstance.py:1401} INFO - Marking task as FAILED. dag_id=nyc_bus_breakdown_pipeline, task_id=processing_data, execution_date=20220603T005229, start_date=20220603T005244, end_date=20220603T005245
[2022-06-03 00:52:45,268] {standard_task_runner.py:97} ERROR - Failed to execute job 114 for task processing_data (The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().; 5334)
[2022-06-03 00:52:45,302] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-03 00:52:45,342] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
